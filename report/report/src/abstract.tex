CPU emulators are widely used in security infrastructure, from malware sandboxes to cross-architecture exploit development. Despite this, their accuracy on instruction corner cases has not been systematically evaluated. In fact, this research presents a structured assessment of x86-64 emulator behavior for security-relevant CPU instructions, testing eight commonly deployed emulators.
To this end, we developed a trait-based testing framework in Rust that provides a uniform interface for executing test cases across different emulator implementations. The framework separates test logic from emulator-specific integration details, thereby enabling direct comparison of behaviors from native hardware execution to subprocess invocation and FFI bindings. Moreover, our tests revealed substantial inaccuracies in how emulators handle edge cases in floating-point operations, CPU flags, and processor identification instructions.
Nevertheless, the extensible framework supports future research on additional CPU behaviors and architectures beyond x86-64, offering practical guidance for security researchers and emulator developers.
